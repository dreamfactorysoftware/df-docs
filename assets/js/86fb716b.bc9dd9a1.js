"use strict";(self.webpackChunkdf_docs=self.webpackChunkdf_docs||[]).push([[517],{242:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});var i=a(4848),r=a(8453);const t={sidebar_position:1},o="Database APIs",s={id:"DreamFactory Configuration/Optimizing DreamFactory/database",title:"Database APIs",description:"Ensuring the DreamFactory-generated database APIs are running at peak performance is accomplished by ensuring your database is properly configured, has been allocated appropriate hardware and network resources, and by turning on DreamFactory\u2019s database caching feature. All of these tasks are covered in this topic.",source:"@site/docs/DreamFactory Configuration/Optimizing DreamFactory/database.md",sourceDirName:"DreamFactory Configuration/Optimizing DreamFactory",slug:"/DreamFactory Configuration/Optimizing DreamFactory/database",permalink:"/DreamFactory Configuration/Optimizing DreamFactory/database",draft:!1,unlisted:!1,editUrl:"https://github.com/dreamfactorysoftware/df-docs/tree/main/docs/DreamFactory Configuration/Optimizing DreamFactory/database.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"intro",previous:{title:"Basic Configuration",permalink:"/DreamFactory Configuration/configuration"},next:{title:"Web Server",permalink:"/DreamFactory Configuration/Optimizing DreamFactory/webserver"}},c={},d=[{value:"Index the database",id:"index-the-database",level:2},{value:"Database API caching",id:"database-api-caching",level:2},{value:"Connection pooling",id:"connection-pooling",level:2},{value:"Adding Redis caching",id:"adding-redis-caching",level:2},{value:"Compiling the DreamFactory code with OPcache",id:"compiling-the-dreamfactory-code-with-opcache",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"database-apis",children:"Database APIs"})}),"\n",(0,i.jsx)(n.p,{children:"Ensuring the DreamFactory-generated database APIs are running at peak performance is accomplished by ensuring your database is properly configured, has been allocated appropriate hardware and network resources, and by turning on DreamFactory\u2019s database caching feature. All of these tasks are covered in this topic."}),"\n",(0,i.jsx)(n.h2,{id:"index-the-database",children:"Index the database"}),"\n",(0,i.jsx)(n.p,{children:"For database-backed APIs, there is no more impactful task than properly indexing the database. Database indexing is what allows your database engine to quickly identify which rows match conditions defined by a where clause. Refer to the following resources for both general and database-specific indexing information:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Database_index",children:"Database Indexes Defined"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/sql/relational-databases/indexes/indexes?view=sql-server-2017",children:"Microsoft SQL Server"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.mongodb.com/manual/indexes/",children:"MongoDB"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/5.7/en/optimization-indexes.html",children:"MySQL"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.oracle.com/cd/E11882_01/server.112/e40540/indexiot.htm#CNCPT721",children:"Oracle"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.postgresql.org/docs/9.1/indexes.html",children:"PostgreSQL"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"database-api-caching",children:"Database API caching"}),"\n",(0,i.jsxs)(n.p,{children:["Enable database API caching whenever practical, as it improves performance. Toggle ",(0,i.jsx)(n.strong,{children:"Data Retrieval Caching Enabled"})," and configure the ",(0,i.jsx)(n.strong,{children:"Cache Time To Live"})," setting in your database API overview."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Example Database API Caching Configuration",src:a(7071).A+"",width:"2450",height:"867"})}),"\n",(0,i.jsx)(n.h2,{id:"connection-pooling",children:"Connection pooling"}),"\n",(0,i.jsxs)(n.p,{children:["Connection pooling is not as prevelent in databases where connections are cheap (MySQL), but can be of increasing value with expensive connections such as Oracle. You may see performance improvements by setting up ",(0,i.jsx)(n.strong,{children:"Connection Pooling"})," to reduces the number of database connections being made. To do so with your DreamFactory Oracle connector, simple add ",(0,i.jsx)(n.code,{children:"PDO::ATTR_PERSISTENT"})," to ",(0,i.jsx)(n.code,{children:"true"})," as a driver option on the configuration tab of your Oracle dashboard or any database API Service."]}),"\n",(0,i.jsx)(n.h2,{id:"adding-redis-caching",children:"Adding Redis caching"}),"\n",(0,i.jsx)(n.p,{children:"One of DreamFactory\u2019s great advantages is it is built on top of Laravel, which allows you to take advantage of Laravel\u2019s support for shared caching solutions, among other things. This is beneficial because it means the caching solution has been extensively tested and proven in production environments."}),"\n",(0,i.jsx)(n.p,{children:"To install the predis package:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Navigate to your project\u2019s root directory and execute this command:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$ composer require predis/predis\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Open your .env file and look for this section:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# CACHE_DRIVER options: apc, array, database, file, memcached, redis\r\nCACHE_DRIVER=file\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Change CACHE_DRIVER to:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"CACHE_DRIVER=redis\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["Scroll down and uncomment these lines by removing the ",(0,i.jsx)(n.code,{children:"#"}),", and then update the CACHE_HOST, CACHE_PORT, and (optionally) the CACHE_PASSWORD parameters to match your Redis environment:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# If CACHE_DRIVER = memcached or redis\r\n#CACHE_HOST=\r\n#CACHE_PORT=\r\n#CACHE_PASSWORD=\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"To complete the process, scroll down to the following section and uncomment CACHE_DATABASE and REDIS_CLIENT:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# If CACHE_DRIVER = redis\r\n#CACHE_DATABASE=2\r\n# Which Redis client to use: predis or phpredis (PHP extension)\r\n#REDIS_CLIENT=predis\n"})}),"\n",(0,i.jsx)(n.p,{children:"You can leave CACHE_DATABASE set to 2. For the REDIS_CLIENT you can leave it set to predis if you\u2019ve installed the predis/predis package (recommended). By default your Redis Database is set to 0, so be sure to SELECT whatever the number is you have set your CACHE_DATABASE equal to. Then you can start seeing the KEYS populate."}),"\n",(0,i.jsx)(n.h2,{id:"compiling-the-dreamfactory-code-with-opcache",children:"Compiling the DreamFactory code with OPcache"}),"\n",(0,i.jsx)(n.p,{children:"You can achieve particularly high performance by compiling your DreamFactory application code using OPcache. The following resources provide more details on the process:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://php.net/manual/en/book.opcache.php",children:"PHP\u2019s OPcache Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://medium.com/appstract/make-your-laravel-app-fly-with-php-opcache-9948db2a5f93",children:"How to Make your Laravel App Fly"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},7071:(e,n,a)=>{a.d(n,{A:()=>i});const i=a.p+"assets/images/database-caching-47dd010977b0bbd8a3ad2eb153523438.png"},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>s});var i=a(6540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);